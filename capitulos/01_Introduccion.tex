\chapter{Introducción}

\section{Motivación y antecedentes}

Dada la gran expansión de Internet desde los años 90, la seguridad se ha convertido en algo 
fundamental. Hoy en día el uso de Internet se ha generalizado tanto que ha llegado a todas las áreas, 
desde finanzas hasta el envío de pruebas médicas, pasando por compras, redes sociales y demás, por lo tanto 
se tratan temas de carácter muy  privado y personal.

\intro Internet se organiza mediante un modelo de capas. Hay varios modelos de capas, como son el modelo TCP/IP y el modelo OSI. \cite{redes2010}

\begin{figure}[H]
  \includegraphics[width=1\textwidth]{imagenes/capas.png}
  \centering
  \caption{Modelos de capas de Internet.}
\end{figure}

Dentro del modelo TCP/IP, que es el que se seguirá en este proyecto, es importante tener claro las siguientes 
capas, pues forma parte de los conocimientos básicos para lograr entender el emparejamiento de flujos.

\begin{itemize}

\item \textbf{Capa de aplicación}

En la capa de aplicación se encontrarán las aplicaciones de red y sus protocolos. 
Los protocolos que se encuentran en esta capa son HTTP, SMTP y FTP.

\begin{itemize}
\item El protocolo \textit{HTTP} permite la solicitud y transferencia de documentos web.
\item El protocolo \textit{SMTP} permite la transferencia de mensajes de correo electrónico.
\item El protocolo \textit{FTP} permite la transferencia de archivos entre dos terminales.
\end{itemize}

A parte de estos protocolos también corresponde a esta capa el \textbf{DNS}, el cual se encarga 
de traducir los nombres de los sitios web. 

\intro Para una información más extensa sobre la capa de aplicación consulte \cite{redes2010b}

\item \textbf{Capa de transporte}

La capa de transporte es la encargada de transportar los mensajes de la capa de aplicación. 
Los protocolos de esta capa son \textbf{TCP y UDP}. La principal diferencia y será algo que 
siempre se debe de tener presente cuando se trabaja con redes es que \textit{TCP} está orientado 
a garantizar la conexión, mientras que \textit{UDP} no garantiza la conexión.
\intro Para ampliar información sobre esta capa consulte \cite{redes2010c}

\begin{figure}[H]
  \includegraphics[width=1\textwidth]{imagenes/tcpudp.jpeg}
  \centering
  \caption{Diagrama de conexión de TCP y UDP.}
\end{figure}

\item \textbf{Capa de red}

En la capa de red es donde se encuentra el protocolo \textbf{IP}, el cual es el encargado de especificar 
el formato de envío entre los routers y los hosts y también el protocolo \textbf{ICMP}, el cual 
es un protocolo de control.

\intro En esencia, esta capa es la que se encarga de transportar los \textit{datagramas} de un \textit{host} a otro.

\intro Para ampliar sus conocimientos sobre la capa de red consulte \cite{redes2010d}

\end{itemize}

\intro En Internet la información que se envía se divide en paquetes. Estos paquetes tienen una IP de 
origen y otra de destino, así como un puerto de origen y un puerto de destino. Estos paquetes, que contienen 
parte de la información que se envía por la red, son unidos de nuevo una vez que llegan a su destino, de forma 
que entonces se dispondrá de la información completa. Dependiendo del tipo de protocolo se tolerarán perdidas 
de paquetes o no, por ilustrarlo en una llamada mediante \textit{Skype} se tolera perder algunos paquetes, 
pues no se notará mucha diferencia. Si se pierden muchos paquetes la imagen se verá borrosa 
y la voz no se escuchará bien. Ahora en un correo electrónico, no se tolerará perder paquetes, 
pues entonces no se obtendrá la información completa. Cuando varios paquetes tienen el mismo origen y 
el mismo destino se denomina flujo. \cite{redes2010a}

\intro De esta forma se llega al emparejamiento de flujos, el cual es muy útil para los NMS, 
sistemas de monitoreo de red, \textit{Network Monitoring System}, como podría ser BRO \cite{broindex}.
Gracias al uso de estos programas el administrador de sistemas podrá prevenir ataques, como por ejemplo, los 
de denegación de servicio, DDoS, \textit{Distributed Denial of Service} \cite{redes2010e}. Un administrador 
de sistemas deberá de garantizar que el recurso que facilita y gestiona esté operativo siempre, 
por lo tanto deberá de analizar el tráfico para evitar los posibles ataques, virus, etc.

\intro Existen otras técnicas de clasificación de tráfico, como se puede ver en el artículo del 
departamento \citep{comparacion}, estas técnicas son: 

\begin{itemize}
\item Clasificación basada en los puertos de la capa de transporte. \cite{iana}
\item Clasificación basada en el contenido del paquete. \cite{payload}
\item Clasificación basada en la aplicación de técnicas de aprendizaje automático sobre estadísticas 
de tráfico. \cite{learning}
\end{itemize}

Estas técnicas no son muy eficaces hoy en día, pues por ejemplo, la primera de las tres puede ser burlada 
haciendo pasar cualquier tipo de conexión por el puerto 80. En la segunda, como se accede al paquete, bastará con que los datos estén 
encriptados para que no se pueda acceder a dicho paquete, a parte de que no respeta la privacidad. Por lo tanto estas 
dos técnicas son obviadas y se utiliza la tercera como opción más fiable, aunque tiene como inconveniente que 
necesita tiempo para aprender a clasificar bien el tráfico.

\intro Por lo tanto es necesario un nuevo método de clasificación, que sea funcional en cualquier circunstancia 
y sea eficiente desde el principio. Por ello el método de emparejamiento planteado por el departamento es 
muy atractivo al ser necesario saber solo las IP's y los puertos, ya que se respeta la seguridad. \cite{comparacion}

\section{Objetivos}

El objetivo del trabajo es desarrollar un módulo para Bro. En este módulo irá implementada la 
técnica de emparejamiento de flujos, de forma que pueda ser usada en redes fuera de un entorno de laboratorio.

\intro Para ello será necesario conocer como Bro gestiona los flujos, desde su nacimiento a su muerte. 

\intro También hará falta gestionar las entradas y salidas, aunque al principio se hará uso de un 
archivo \textit{pcap} de prueba para controlar si todo funciona bien, 
pudiendo pasar luego a analizar el tráfico de una red online.

\intro Será necesario realizar pruebas al módulo que se pretende desarrollar, de modo que se detecten los 
errores y se subsanen.

\section{Metodología}

Para realizar este trabajo se establecen una serie de tareas:

\begin{itemize}
\item Estudio del uso de Bro y de su lenguaje de scripting.
\item Pruebas con el lenguaje propio de Bro.
\item Lectura del artículo del departamento. \cite{comparacion}
\item Desarrollo del módulo en Bro.
\item Pruebas del módulo.
\end{itemize}

Cada tarea anterior se realimentará de la siguiente, el ejemplo más claro es el desarrollo del módulo, que 
irá cambiando por las pruebas, pues se detectarán los fallos, a su vez habrá que releer el artículo mientras 
se desarrolla el módulo para asegurarse de que todo se realiza de acuerdo al trabajo previo, etc.

\intro En el siguiente diagrama de Gantt se puede ver una temporización de estas tareas. 

\begin{figure}[H]
  \includegraphics[width=1\textwidth]{imagenes/temporizacion.png} 
  \centering
  \caption{Temporización en diagrama de Gantt.}
\end{figure}

Este proyecto no necesita de ningún gasto, pues Bro \cite{broindex} proporciona sus binarios de 
forma gratuita. El módulo será subido a GitHub \cite{repo} con licencia de software libre, por lo que cualquiera 
podrá usarlo o modificarlo en el futuro. El único \textit{gasto} es el de un ordenador con Linux, 
o bien con Mac OS X, pues de momento no está disponible para Windows. \cite{brodownload}

\section{Estructura de la memoria}

Esta memoria se organizará de la siguiente forma: En el capítulo 2 se hablará de 
todos los fundamentos teóricos y tecnológicos sobre los que se basa este proyecto. 
En el capítulo 3 se contará cómo se pretende resolver el problema expuesto. En el 
capítulo 4 se encontrarán detalles de cómo se han implementado los diferentes módulos. 
En el capítulo 5 se verán las pruebas realizadas, para comprobar que todo funciona como 
estaba previsto, tanto a nivel funcional, como a nivel de aplicación. En el último capítulo 
se verán las conclusiones del trabajo y cómo podría seguir trabajándose en el futuro.
